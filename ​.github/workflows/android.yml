name: Android Build

on:
  push:
    branches:
      - main

jobs:
  build:
    name: Build APK
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      # Əgər əsas fayllar (main.py və buildozer.spec) yoxdursa, yer tutan boş fayllar yaradırıq.
      # Bu, APK yaratma prosesinin baş tutması üçün vacibdir.
      - name: Create placeholder files if missing
        run: |
          echo "from kivy.app import App; from kivy.uix.label import Label; class TestApp(App): def build(self): return Label(text='Sizin APK Hazırlanır...'); TestApp().run()" > main.py
          echo "[app]\ntitle = Placeholder\npackage.name = com.test.placeholder\nrequirements=python3,kivy" > buildozer.spec

      - name: Set up Buildozer
        uses: ArtemSBulgakov/buildozer-action@v1
        with:
          target-platform: android
          build-cmd: buildozer android debug

      - name: Upload Artifact
        uses: actions/upload-artifact@v4
        with:
          name: Gemini-Agent-APK
          path: bin/*.apk
